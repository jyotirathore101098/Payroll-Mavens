{"ast":null,"code":"// src/pages/PayrollRunPage/payrollRunService.js\nimport axios from \"axios\";\nconst API_BASE_URL = \"http://localhost:3000/api/payroll-runs\";\nconst API_BASE_PAYROLL = \"http://localhost:3000/api/payroll-base\";\nconst API_BASE_LEAVES = \"http://localhost:3000/api/leaves\";\nconst API_BASE_ADJUSTMENTS = \"http://localhost:3000/api/adjustments\";\nconst getToken = () => localStorage.getItem(\"token\");\nexport const fetchRuns = async () => {\n  const res = await axios.get(API_BASE_URL, {\n    headers: {\n      Authorization: `Bearer ${getToken()}`\n    }\n  });\n  return res.data;\n};\nexport const insertRun = async data => {\n  return axios.post(API_BASE_URL, data, {\n    headers: {\n      Authorization: `Bearer ${getToken()}`\n    }\n  });\n};\nexport const deleteRun = async id => {\n  return axios.delete(`${API_BASE_URL}/${id}`, {\n    headers: {\n      Authorization: `Bearer ${getToken()}`\n    }\n  });\n};\n\n// Payroll Preview Calculation\nexport const fetchPreview = async (userId, monthYear) => {\n  const token = getToken();\n\n  // Payroll base\n  const baseRes = await axios.get(`${API_BASE_PAYROLL}/${userId}`, {\n    headers: {\n      Authorization: `Bearer ${token}`\n    }\n  });\n  const base = baseRes.data;\n\n  // Leaves\n  const leaveRes = await axios.get(`${API_BASE_LEAVES}/${userId}`, {\n    headers: {\n      Authorization: `Bearer ${token}`\n    }\n  });\n  const leaves = Array.isArray(leaveRes.data) ? leaveRes.data.filter(l => l.MonthYear === monthYear) : [];\n  const lop = leaves.filter(l => l.LeaveType === \"LOP\").reduce((sum, l) => sum + Number(l.LeaveDays), 0);\n\n  // Adjustments\n  const adjRes = await axios.get(`${API_BASE_ADJUSTMENTS}/${userId}`, {\n    headers: {\n      Authorization: `Bearer ${token}`\n    }\n  });\n  const adjustments = Array.isArray(adjRes.data) ? adjRes.data.filter(a => a.MonthYear === monthYear) : [];\n  const bonus = adjustments.filter(a => a.AdjustmentType === \"Bonus\").reduce((sum, a) => sum + Number(a.Amount), 0);\n  const deduction = adjustments.filter(a => a.AdjustmentType === \"Deduction\").reduce((sum, a) => sum + Number(a.Amount), 0);\n\n  // Salary calculation\n  let grossSalary = Number(base.BasicSalary || 0) + Number(base.HRA || 0) + Number(base.DA || 0) + Number(base.OtherAllowance || 0);\n  const lopDeduction = +(lop * (grossSalary / 30)).toFixed(2);\n  grossSalary -= lopDeduction;\n  const adjustedGross = grossSalary + bonus - deduction;\n  const PF = +(adjustedGross * 0.12).toFixed(2);\n  const ESI = +(adjustedGross * 0.0075).toFixed(2);\n  const TDS = +(adjustedGross * 0.1).toFixed(2);\n  const netSalary = +(adjustedGross - PF - ESI - TDS).toFixed(2);\n  return {\n    base,\n    leaves,\n    adjustments,\n    grossSalary,\n    lop,\n    lopDeduction,\n    bonus,\n    deduction,\n    adjustedGross,\n    PF,\n    ESI,\n    TDS,\n    netSalary\n  };\n};","map":{"version":3,"names":["axios","API_BASE_URL","API_BASE_PAYROLL","API_BASE_LEAVES","API_BASE_ADJUSTMENTS","getToken","localStorage","getItem","fetchRuns","res","get","headers","Authorization","data","insertRun","post","deleteRun","id","delete","fetchPreview","userId","monthYear","token","baseRes","base","leaveRes","leaves","Array","isArray","filter","l","MonthYear","lop","LeaveType","reduce","sum","Number","LeaveDays","adjRes","adjustments","a","bonus","AdjustmentType","Amount","deduction","grossSalary","BasicSalary","HRA","DA","OtherAllowance","lopDeduction","toFixed","adjustedGross","PF","ESI","TDS","netSalary"],"sources":["/Users/jyotirathore101098/Documents/Payroll_Mavens/frontend/src/pages/payrollRun/payrollRunService.js"],"sourcesContent":["// src/pages/PayrollRunPage/payrollRunService.js\nimport axios from \"axios\";\n\nconst API_BASE_URL = \"http://localhost:3000/api/payroll-runs\";\nconst API_BASE_PAYROLL = \"http://localhost:3000/api/payroll-base\";\nconst API_BASE_LEAVES = \"http://localhost:3000/api/leaves\";\nconst API_BASE_ADJUSTMENTS = \"http://localhost:3000/api/adjustments\";\n\nconst getToken = () => localStorage.getItem(\"token\");\n\nexport const fetchRuns = async () => {\n  const res = await axios.get(API_BASE_URL, {\n    headers: { Authorization: `Bearer ${getToken()}` },\n  });\n  return res.data;\n};\n\nexport const insertRun = async (data) => {\n  return axios.post(API_BASE_URL, data, {\n    headers: { Authorization: `Bearer ${getToken()}` },\n  });\n};\n\nexport const deleteRun = async (id) => {\n  return axios.delete(`${API_BASE_URL}/${id}`, {\n    headers: { Authorization: `Bearer ${getToken()}` },\n  });\n};\n\n// Payroll Preview Calculation\nexport const fetchPreview = async (userId, monthYear) => {\n  const token = getToken();\n\n  // Payroll base\n  const baseRes = await axios.get(`${API_BASE_PAYROLL}/${userId}`, {\n    headers: { Authorization: `Bearer ${token}` },\n  });\n  const base = baseRes.data;\n\n  // Leaves\n  const leaveRes = await axios.get(`${API_BASE_LEAVES}/${userId}`, {\n    headers: { Authorization: `Bearer ${token}` },\n  });\n  const leaves = Array.isArray(leaveRes.data)\n    ? leaveRes.data.filter((l) => l.MonthYear === monthYear)\n    : [];\n  const lop = leaves.filter((l) => l.LeaveType === \"LOP\").reduce((sum, l) => sum + Number(l.LeaveDays), 0);\n\n  // Adjustments\n  const adjRes = await axios.get(`${API_BASE_ADJUSTMENTS}/${userId}`, {\n    headers: { Authorization: `Bearer ${token}` },\n  });\n  const adjustments = Array.isArray(adjRes.data)\n    ? adjRes.data.filter((a) => a.MonthYear === monthYear)\n    : [];\n  const bonus = adjustments.filter((a) => a.AdjustmentType === \"Bonus\").reduce((sum, a) => sum + Number(a.Amount), 0);\n  const deduction = adjustments.filter((a) => a.AdjustmentType === \"Deduction\").reduce((sum, a) => sum + Number(a.Amount), 0);\n\n  // Salary calculation\n  let grossSalary = Number(base.BasicSalary || 0) + Number(base.HRA || 0) + Number(base.DA || 0) + Number(base.OtherAllowance || 0);\n  const lopDeduction = +(lop * (grossSalary / 30)).toFixed(2);\n  grossSalary -= lopDeduction;\n\n  const adjustedGross = grossSalary + bonus - deduction;\n  const PF = +(adjustedGross * 0.12).toFixed(2);\n  const ESI = +(adjustedGross * 0.0075).toFixed(2);\n  const TDS = +(adjustedGross * 0.1).toFixed(2);\n  const netSalary = +(adjustedGross - PF - ESI - TDS).toFixed(2);\n\n  return { base, leaves, adjustments, grossSalary, lop, lopDeduction, bonus, deduction, adjustedGross, PF, ESI, TDS, netSalary };\n};\n"],"mappings":"AAAA;AACA,OAAOA,KAAK,MAAM,OAAO;AAEzB,MAAMC,YAAY,GAAG,wCAAwC;AAC7D,MAAMC,gBAAgB,GAAG,wCAAwC;AACjE,MAAMC,eAAe,GAAG,kCAAkC;AAC1D,MAAMC,oBAAoB,GAAG,uCAAuC;AAEpE,MAAMC,QAAQ,GAAGA,CAAA,KAAMC,YAAY,CAACC,OAAO,CAAC,OAAO,CAAC;AAEpD,OAAO,MAAMC,SAAS,GAAG,MAAAA,CAAA,KAAY;EACnC,MAAMC,GAAG,GAAG,MAAMT,KAAK,CAACU,GAAG,CAACT,YAAY,EAAE;IACxCU,OAAO,EAAE;MAAEC,aAAa,EAAE,UAAUP,QAAQ,CAAC,CAAC;IAAG;EACnD,CAAC,CAAC;EACF,OAAOI,GAAG,CAACI,IAAI;AACjB,CAAC;AAED,OAAO,MAAMC,SAAS,GAAG,MAAOD,IAAI,IAAK;EACvC,OAAOb,KAAK,CAACe,IAAI,CAACd,YAAY,EAAEY,IAAI,EAAE;IACpCF,OAAO,EAAE;MAAEC,aAAa,EAAE,UAAUP,QAAQ,CAAC,CAAC;IAAG;EACnD,CAAC,CAAC;AACJ,CAAC;AAED,OAAO,MAAMW,SAAS,GAAG,MAAOC,EAAE,IAAK;EACrC,OAAOjB,KAAK,CAACkB,MAAM,CAAC,GAAGjB,YAAY,IAAIgB,EAAE,EAAE,EAAE;IAC3CN,OAAO,EAAE;MAAEC,aAAa,EAAE,UAAUP,QAAQ,CAAC,CAAC;IAAG;EACnD,CAAC,CAAC;AACJ,CAAC;;AAED;AACA,OAAO,MAAMc,YAAY,GAAG,MAAAA,CAAOC,MAAM,EAAEC,SAAS,KAAK;EACvD,MAAMC,KAAK,GAAGjB,QAAQ,CAAC,CAAC;;EAExB;EACA,MAAMkB,OAAO,GAAG,MAAMvB,KAAK,CAACU,GAAG,CAAC,GAAGR,gBAAgB,IAAIkB,MAAM,EAAE,EAAE;IAC/DT,OAAO,EAAE;MAAEC,aAAa,EAAE,UAAUU,KAAK;IAAG;EAC9C,CAAC,CAAC;EACF,MAAME,IAAI,GAAGD,OAAO,CAACV,IAAI;;EAEzB;EACA,MAAMY,QAAQ,GAAG,MAAMzB,KAAK,CAACU,GAAG,CAAC,GAAGP,eAAe,IAAIiB,MAAM,EAAE,EAAE;IAC/DT,OAAO,EAAE;MAAEC,aAAa,EAAE,UAAUU,KAAK;IAAG;EAC9C,CAAC,CAAC;EACF,MAAMI,MAAM,GAAGC,KAAK,CAACC,OAAO,CAACH,QAAQ,CAACZ,IAAI,CAAC,GACvCY,QAAQ,CAACZ,IAAI,CAACgB,MAAM,CAAEC,CAAC,IAAKA,CAAC,CAACC,SAAS,KAAKV,SAAS,CAAC,GACtD,EAAE;EACN,MAAMW,GAAG,GAAGN,MAAM,CAACG,MAAM,CAAEC,CAAC,IAAKA,CAAC,CAACG,SAAS,KAAK,KAAK,CAAC,CAACC,MAAM,CAAC,CAACC,GAAG,EAAEL,CAAC,KAAKK,GAAG,GAAGC,MAAM,CAACN,CAAC,CAACO,SAAS,CAAC,EAAE,CAAC,CAAC;;EAExG;EACA,MAAMC,MAAM,GAAG,MAAMtC,KAAK,CAACU,GAAG,CAAC,GAAGN,oBAAoB,IAAIgB,MAAM,EAAE,EAAE;IAClET,OAAO,EAAE;MAAEC,aAAa,EAAE,UAAUU,KAAK;IAAG;EAC9C,CAAC,CAAC;EACF,MAAMiB,WAAW,GAAGZ,KAAK,CAACC,OAAO,CAACU,MAAM,CAACzB,IAAI,CAAC,GAC1CyB,MAAM,CAACzB,IAAI,CAACgB,MAAM,CAAEW,CAAC,IAAKA,CAAC,CAACT,SAAS,KAAKV,SAAS,CAAC,GACpD,EAAE;EACN,MAAMoB,KAAK,GAAGF,WAAW,CAACV,MAAM,CAAEW,CAAC,IAAKA,CAAC,CAACE,cAAc,KAAK,OAAO,CAAC,CAACR,MAAM,CAAC,CAACC,GAAG,EAAEK,CAAC,KAAKL,GAAG,GAAGC,MAAM,CAACI,CAAC,CAACG,MAAM,CAAC,EAAE,CAAC,CAAC;EACnH,MAAMC,SAAS,GAAGL,WAAW,CAACV,MAAM,CAAEW,CAAC,IAAKA,CAAC,CAACE,cAAc,KAAK,WAAW,CAAC,CAACR,MAAM,CAAC,CAACC,GAAG,EAAEK,CAAC,KAAKL,GAAG,GAAGC,MAAM,CAACI,CAAC,CAACG,MAAM,CAAC,EAAE,CAAC,CAAC;;EAE3H;EACA,IAAIE,WAAW,GAAGT,MAAM,CAACZ,IAAI,CAACsB,WAAW,IAAI,CAAC,CAAC,GAAGV,MAAM,CAACZ,IAAI,CAACuB,GAAG,IAAI,CAAC,CAAC,GAAGX,MAAM,CAACZ,IAAI,CAACwB,EAAE,IAAI,CAAC,CAAC,GAAGZ,MAAM,CAACZ,IAAI,CAACyB,cAAc,IAAI,CAAC,CAAC;EACjI,MAAMC,YAAY,GAAG,CAAC,CAAClB,GAAG,IAAIa,WAAW,GAAG,EAAE,CAAC,EAAEM,OAAO,CAAC,CAAC,CAAC;EAC3DN,WAAW,IAAIK,YAAY;EAE3B,MAAME,aAAa,GAAGP,WAAW,GAAGJ,KAAK,GAAGG,SAAS;EACrD,MAAMS,EAAE,GAAG,CAAC,CAACD,aAAa,GAAG,IAAI,EAAED,OAAO,CAAC,CAAC,CAAC;EAC7C,MAAMG,GAAG,GAAG,CAAC,CAACF,aAAa,GAAG,MAAM,EAAED,OAAO,CAAC,CAAC,CAAC;EAChD,MAAMI,GAAG,GAAG,CAAC,CAACH,aAAa,GAAG,GAAG,EAAED,OAAO,CAAC,CAAC,CAAC;EAC7C,MAAMK,SAAS,GAAG,CAAC,CAACJ,aAAa,GAAGC,EAAE,GAAGC,GAAG,GAAGC,GAAG,EAAEJ,OAAO,CAAC,CAAC,CAAC;EAE9D,OAAO;IAAE3B,IAAI;IAAEE,MAAM;IAAEa,WAAW;IAAEM,WAAW;IAAEb,GAAG;IAAEkB,YAAY;IAAET,KAAK;IAAEG,SAAS;IAAEQ,aAAa;IAAEC,EAAE;IAAEC,GAAG;IAAEC,GAAG;IAAEC;EAAU,CAAC;AAChI,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}